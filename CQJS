import React from 'react';
import {
    View,
    Text,
    TouchableOpacity,
    StyleSheet,
    ActivityIndicator,
    FlatList,
    TextInput,
    Button,
    Alert,
    Platform,
} from 'react-native';

import {StackNavigator} from 'react-navigation';
import MenuButtonWS from '../Components/MenuButtonWS';


export default class CustomerQue extends React.Component {

    constructor(props){
        super(props);
        this.state = {
            rlocationcode: '',
            dataSource: [],
        };
    }

    componentDidMount() {
        this.grabCustomers();
    }

    itemSeparator = () => {
        return (
            <View 
                style={{
                    height: 5,
                    width: "100%",
                    backgroundColor: "#fff",
                }}
            />
        );
    }
    

    render() {

        return (
            <View style={styles.Maincontainer}>
                <MenuButtonWS navigation={this.props.navigation} />

                <TextInput
                    style={styles.textInput} placeholder='Customers User ID'
                    onChangeText={(rlocationcode) => this.setState({rlocationcode})}
                    value={this.state.rlocationcode}
                    underlineColorAndroid='transparent'
                />

                <TouchableOpacity
                    style={styles.btn}
                    onPress={this.grabCustomers}>
                    <Text>Customer Que</Text>
                </TouchableOpacity>

                <FlatList
                    
                    data={this.state.dataSource}
                    extraData={this.state}
                    keyExtractor={(item, index) => index.toString()}
                    ItemSeparatorComponent={this.itemSeparator}
                    style={{ marginTop: 10 }}
                    renderItem={({ item }) => (
                        <View>
                            <Text style={styles.row}>{`${this.state.dataSource}`}</Text>
                            
                        </View>
                    )}
                />
    
            </View>
        );   
    }

    grabCustomers = () => {
        let rlc = {
            rlocationcode: this.state.rlocationcode,
        };
        
        fetch('URL', {
            method: 'POST',
            body: JSON.stringify(rlc),
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json',
            },
        })
            .then((response) => response.text())
            .then((responseJson) => {
                this.setState({
                    dataSource: responseJson
                });
                console.log(responseJson)
            })
            .catch((error) => {
                console.log(error);
            });
    }
    GetFlatListItem(uname) {
        Alert.alert(uname);
    }
}
const styles = StyleSheet.create({
    Maincontainer: {
        flex: 1,
        backgroundColor: '#40B7FA',
        alignItems: 'center',
        justifyContent: 'center',
        paddingLeft: 80,
        paddingRight: 80,
    },
    row: {
        fontSize: 18,
        padding: 12,
    },
    textInput: {
        textAlign: 'center',
        height: 42,
        backgroundColor: '#fff',
        borderRadius: 8,
        borderWidth: 1,
        borderColor: '#030303',
        fontWeight: 'bold',
    },
    btn: {
        alignSelf: 'stretch',
        backgroundColor: '#fff',
        padding: 20,
        paddingBottom: 20,
        alignItems: 'center',
        borderRadius: 50,
    },
    text: {
        color: '#fff',
    }
})
