export default class CustomerQue extends React.Component {

    constructor(props){
        super(props);
        this.state = {
            rlocationcode: '',
            dataSource: [],
            selectedUsers: [],
        };
    }

    componentDidMount() {
        this.grabCustomers();
    }

    handleTouchItem = (selectedUsers) => {
        this.props.navigation.navigate("Tables", {
            cust_ID: selectedUsers,
            otherParam: '101',
        });
    }

    _didSelectUsers = (item) => {
        let selectedUsers1 = this.state.selectedUsers;
        let isItemSelected = selectedUsers1.filter(item => {
            return item.includes(item);
        }).length > 0
            ? true : false;

        if (isItemSelected) {
            const index = selectedUsers1.findIndex(
                obj => obj.item === selectedUsers1
            );
            selectedUsers1.splice(index, 1);
        } else {
            selectedUsers1.push(item);
        }

        this.setState({ selectedUsers1 });
    }

    render() {

        return (
            <View style={styles.Maincontainer}>
                <MenuButtonWS navigation={this.props.navigation} />
                
                <TextInput
                    style={styles.textInput} placeholder='Customers User ID'
                    onChangeText={ (rlocationcode) => this.setState({rlocationcode}) }
                    value={this.state.rlocationcode}
                    underlineColorAndroid='transparent'
                />

                <TouchableOpacity
                    style={styles.btn}
                    onPress={this.grabCustomers}>
                    <Text>Customer Que</Text>
                </TouchableOpacity>

                
                <FlatList
                    data={this.state.dataSource}
                    extraData={this.state}
                    keyExtractor={(item, index) => item.toString()}
                    numColumns={numColumns}
                    style={{ marginTop: 10 }}
                    renderItem={({ item }) => (
                        <TouchableOpacity onPress={() => this._didSelectUsers(item)}>
                            <View style={styles.itemStyle}>
                                <Text style={styles.row}>{`${item}`}</Text>
                            </View>
                        </TouchableOpacity>
                    )}
                />

               <View>
               <>
                <TouchableOpacity 
                style={styles.btn}
                onPress={() => this.handleTouchItem(selectedUsers)}>
                  <Text>Add Customers to tables.</Text>          
                </TouchableOpacity> 

                </>
               </View>
            </View>
        );   
    }
